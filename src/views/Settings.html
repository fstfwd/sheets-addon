<!DOCTYPE html>
<html>
<head>
  
  <base target="_top">

  <!-- Addon -->
  <link rel="stylesheet" href="https://sheetbase.github.io/sheets-addon/css/addon.css">
  <link rel="stylesheet" href="https://sheetbase.github.io/sheets-addon/css/add-ons1.css">

  <style>
  </style>

</head>
<body>

  <main class="container" id="vue">

    <div>Project name: <strong>{{ info.projectName }}</strong></div>

  </main>

  <!-- Vue -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.10/vue.min.js"></script>

  <script>
    
    // init vue app
    var app = new Vue({
      el: '#vue',
      data: {
        page: 'general',
        // data
        general: {},
        info: {},
      },
      methods: {

        errorAlert: function (msg, el, title) {
          console.error(msg, el ? el: '');
          return google.script.run.withFailureHandler(this.errorAlert).displayError(msg, title);
        },

        getProjectInfo: function () {
          var _this = this;
          return google.script.run
          .withSuccessHandler(function (data) {
            var info = JSON.parse(data);
            return _this.info['projectName'] = info.name.replace('Sheetbase: ', '');
          })
          .withFailureHandler(this.errorAlert)
          .getProjectFolderInfoAsString();
        },

      },

    });

  </script>

</body>
</html>