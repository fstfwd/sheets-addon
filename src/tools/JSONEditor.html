<!DOCTYPE html>
<html>
<head>

  <base target="_top">

  <!-- Addon -->
  <link rel="stylesheet" href="https://sheetbase.github.io/sheets-addon/css/addon.css">
  <link rel="stylesheet" href="https://sheetbase.github.io/sheets-addon/css/add-ons1.css">

  <!-- JSON Editor -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/6.3.0/jsoneditor.min.css" />

  <style>
    #jsoneditor {
      width: 100%;
      height: 500px;
    }
  </style>

</head>

<body>

  <div class="container">

    <div id="jsoneditor"></div>
  
    <div class="buttons">
      <button class="button" onclick="getJSON();">Get &rarr;</button>
      <button class="button" onclick="clearJSON();">Clear</button>
      <button class="button action right" onclick="setJSON();">&larr; Set</button>
    </div>

  </div>

  <!-- JSON Editor -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jsoneditor/6.3.0/jsoneditor.min.js"></script>

  <script>

    // init
    var editor = new JSONEditor(
      document.getElementById('jsoneditor'),
    );

    // error
    function errorAlert(msg, el, title) {
      console.error(msg, el ? el: '');
      return google.script.run.withFailureHandler(errorAlert).displayError(msg, title);
    }

    // clear
    function clearJSON() {
      return editor.set({});
    }

    // get
    function getJSON() {
      return google.script.run
      .withSuccessHandler(function (jsonText) {
        try {
          editor.setText(jsonText);
        } catch (e) {
          return errorAlert('Look like your data is not a valid JSON.', null, 'Bad JSON!');
        }
      })
      .withFailureHandler(errorAlert)
      .getData();
    }

    // set
    function setJSON() {
      var jsonText = editor.getText();
      return google.script.run
      .withFailureHandler(errorAlert)
      .setData(jsonText);
    }

  </script>

</body>
</html>